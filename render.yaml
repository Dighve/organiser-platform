services:
  - type: web
    name: hikehub-backend
    env: docker
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    region: frankfurt # Free tier available
    plan: free
    envVars:
      # Java memory settings
      - key: JAVA_TOOL_OPTIONS
        value: "-Xmx512m"
      
      # Database connection (auto-populated by Render)
      - key: DATABASE_URL
        fromDatabase:
          name: hikehub-db
          property: connectionString
      
      # JWT Secret (auto-generated or set manually in dashboard)
      - key: JWT_SECRET
        generateValue: true
      
      # Spring Profile
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      
      # Frontend URL (update after deploying frontend to Netlify)
      - key: FRONTEND_URL
        value: https://www.outmeets.com
      
      # Email Configuration (Resend API)
      - key: RESEND_API_KEY
        sync: false  # Set manually in Render dashboard
      
      - key: EMAIL_FROM
        value: no-reply@outmeets.com
      
      # Cloudinary Configuration (set manually in Render dashboard)
      - key: CLOUDINARY_CLOUD_NAME
        sync: false  # Set manually in Render dashboard
      
      - key: CLOUDINARY_API_KEY
        sync: false  # Set manually in Render dashboard
      
      - key: CLOUDINARY_API_SECRET
        sync: false  # Set manually in Render dashboard
    
    healthCheckPath: /api/v1/actuator/health
    healthCheckTimeout: 60
    healthCheckInterval: 10
    autoDeploy: true

databases:
  - name: hikehub-db
    databaseName: hikehub
    user: hikehub_user
    region: frankfurt
    plan: free # 90-day free trial
